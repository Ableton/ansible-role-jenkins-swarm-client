---
# Unfortunately, since we don't know what state the system is currently in, nor can we log
# a user in via PowerShell, the safest way to start the service is to reboot the system
# and allow Windows to run the service during logon.
- name: Reboot Windows host
  win_reboot:
    post_reboot_delay: 5

- name: Wait until Swarm Client service has started
  slurp:
    path: "{{ jenkins_swarm_pid_file }}"
  register: jenkins_swarm_pid_win
  until: jenkins_swarm_pid_win is success
  retries: 30
  delay: 5
